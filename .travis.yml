language: csharp
os:
- linux
dist: trusty
dotnet: 2.1.300
mono: none
sudo: required
services:
- docker
before_install:
- docker build --target builder -t cryptotuga/neo-sharp:SDK ./containers/
- docker build -t cryptotuga/neo-sharp:latest ./containers/
script:
- dotnet restore
- find test -name *.csproj | xargs -I % dotnet add % package coverlet.msbuild
- dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=opencover
after_success:
- bash <(curl -s https://codecov.io/bash) -v
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=cryptotuga/neo-sharp
- docker push cryptotuga/neo-sharp:SDK
- docker push $REPO
- docker push -t $REPO:runtime $REPO
